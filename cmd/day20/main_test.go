package main

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

var input = [][]string{
	[]string{
		"Tile 2311:",
		"..##.#..#.",
		"##..#.....",
		"#...##..#.",
		"####.#...#",
		"##.##.###.",
		"##...#.###",
		".#.#.#..##",
		"..#....#..",
		"###...#.#.",
		"..###..###",
	},
	[]string{
		"Tile 1951:",
		"#.##...##.",
		"#.####...#",
		".....#..##",
		"#...######",
		".##.#....#",
		".###.#####",
		"###.##.##.",
		".###....#.",
		"..#.#..#.#",
		"#...##.#..",
	},
	[]string{
		"Tile 1171:",
		"####...##.",
		"#..##.#..#",
		"##.#..#.#.",
		".###.####.",
		"..###.####",
		".##....##.",
		".#...####.",
		"#.##.####.",
		"####..#...",
		".....##...",
	},
	[]string{
		"Tile 1427:",
		"###.##.#..",
		".#..#.##..",
		".#.##.#..#",
		"#.#.#.##.#",
		"....#...##",
		"...##..##.",
		"...#.#####",
		".#.####.#.",
		"..#..###.#",
		"..##.#..#.",
	},
	[]string{
		"Tile 1489:",
		"##.#.#....",
		"..##...#..",
		".##..##...",
		"..#...#...",
		"#####...#.",
		"#..#.#.#.#",
		"...#.#.#..",
		"##.#...##.",
		"..##.##.##",
		"###.##.#..",
	},
	[]string{
		"Tile 2473:",
		"#....####.",
		"#..#.##...",
		"#.##..#...",
		"######.#.#",
		".#...#.#.#",
		".#########",
		".###.#..#.",
		"########.#",
		"##...##.#.",
		"..###.#.#.",
	},
	[]string{
		"Tile 2971:",
		"..#.#....#",
		"#...###...",
		"#.#.###...",
		"##.##..#..",
		".#####..##",
		".#..####.#",
		"#..#.#..#.",
		"..####.###",
		"..#.#.###.",
		"...#.#.#.#",
	},
	[]string{
		"Tile 2729:",
		"...#.#.#.#",
		"####.#....",
		"..#.#.....",
		"....#..#.#",
		".##..##.#.",
		".#.####...",
		"####.#.#..",
		"##.####...",
		"##..#.##..",
		"#.##...##.",
	},
	[]string{
		"Tile 3079:",
		"#.#.#####.",
		".#..######",
		"..#.......",
		"######....",
		"####.#..#.",
		".#...#.##.",
		"#.#####.##",
		"..#.###...",
		"..#.......",
		"..#.###...",
	},
}

func TestPart1(t *testing.T) {
	assert.Equal(t, 20899048083289, part1(input))
}

func TestPart2(t *testing.T) {
	assert.Equal(t, 0, part2(input))
}

func TestReverseNum(t *testing.T) {
	assert.Equal(t, edgeValue(13), reverseNumber(11))
}

func TestSetupTilebox(t *testing.T) {
	box := newTileBox(input)

	query := tileQualifier{
		id:      3079,
		variant: Rotate0,
	}
	myTile, ok := box.inventory[query]

	assert.True(t, ok)
	assert.Equal(t, 3079, myTile.qualifier.id)
	assert.Equal(t, edgeValue(0b0111110101), myTile.north.value)
	assert.Equal(t, edgeValue(0b0001000010), myTile.east.value)
	assert.Equal(t, edgeValue(0b0010111000), myTile.south.value)
	assert.Equal(t, edgeValue(0b1001101000), myTile.west.value)
}
